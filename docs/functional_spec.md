# 세부 기능 정의

## 로그인 기능 (MVP 페르소나 테스트 환경)
> **Note:** 본 PoC는 평가자의 원활한 테스트를 위해, 직접 타이핑하는 회원가입 대신 대규모 목업 DB에 사전 구축된 다양한 페르소나(고객)를 선택하여 즉시 환경을 로드하는 방식을 채택했습니다.

### [Task 1] 사전 정의된 고객 프로필 선택 (로그인)
- **Input:** 좌측 사이드바의 드롭다운 메뉴에서 테스트용 고객(예: '고객 04님, 32세')을 선택 후 '로그인' 버튼 클릭.
- **Logic:** `customers.json`에서 해당 고객의 고유 메타데이터(피부 타입, 민감성 여부, 피부 고민 해시태그 등)를 조회하여 Streamlit의 `session_state`에 전역 변수로 캐싱.
- **Output:** - 상태 알림: 사이드바에 "로그인되었습니다." 메시지 출력.
  - UI 렌더링: 메인 대시보드에 고객 개인화 정보(피부 타입 배지, 고민 개수 요약) 동적 노출 및 검색창 활성화.

### [Task 2] 세션 종료 (로그아웃)
- **Input:** 좌측 사이드바의 '로그아웃' 버튼 클릭.
- **Logic:** 현재 활성화된 `session_state` 내의 고객 상태값을 초기화. 데이터베이스의 원본 데이터는 안전하게 유지됨.
- **Output:** 진행 중이던 검색 및 상세 페이지 뷰를 모두 숨기고, 초기 상태인 '고객 선택 안내 화면'으로 즉시 리다이렉트.


## 검색 내용 기반 제품 추천 기능

### [Task 1] 제품 검색용 JSON 생성 (Agent)

* **Input:** Human이 입력한 자연어 검색어 (예: "피부 진정에 좋은 수분크림 추천해줘")
* **Logic:** 사전에 정의된 프롬프트를 통해 LLM(Claude)이 사용자의 의도를 분석하고, `product_type`(상품 종류)과 `concerns`(피부 고민) 파라미터만 정교하게 추출. (LLM은 전체 DB에 절대 접근하지 않음)
* **Output:** 백엔드 시스템이 인식할 수 있는 정형화된 JSON 객체 반환. (예: `{"product_type": "moisture_cream", "concerns": ["redness"]}`)

### [Task 2] 결정론적 상품 필터링 및 리스트 렌더링 (System)

* **Input:** Agent가 파싱하여 넘겨준 JSON 파라미터.
* **Logic:** Pandas를 활용하여 `products.json`에서 해당 조건과 일치하는 상품을 100% 결정론적으로 필터링. 평점순, 후기 많은 순 등 정렬 로직 적용.
* **Output:** 메인 화면에 필터링된 상품 리스트 출력. (SPA 아키텍처를 유지하며, 각 상품 카드의 '상품 선택' 버튼 활성화)

### [Task 3] 상세 뷰 전환 및 타겟 리뷰 추출 (System)

* **Input:** 검색 결과 리스트에서 특정 '상품 선택' 버튼 클릭.
* **Logic:** 1. `session_state`를 업데이트하여 지저분한 스크롤 이동 없이 즉각적으로 '상세 분석 화면'으로 UI 라우팅.
2. `reviews.json`에서 현재 로그인한 고객과 **'동일한 피부 타입'**을 가진 이전 구매자들의 리뷰만 정확히 타겟팅하여 추출.
3. 총 리뷰 수, 평균 평점, 만족도(4점 이상 비율) 등 정량 지표 연산. (리뷰가 0건일 경우 System 단에서 Fallback 방어)
* **Output:** 상세 화면 상단에 정량적 통계 지표 대시보드 렌더링 및 리뷰 텍스트 샘플링(Top N건) 데이터 확보.

### [Task 4] 피부 타입 맞춤형 리뷰 요약 (Agent)

* **Input:** System이 1차로 필터링해 준 '동일 피부 타입 고객의 리뷰 샘플 텍스트' 및 '정량 지표'.
* **Logic:** LLM이 전달받은 제한된 컨텍스트(리뷰 텍스트) 내에서만 Hallucination 없이 전체적인 반응을 2~3문장의 한국어로 요약.
* **Output:** "OO 피부 타입 고객들은 주로 수분감과 진정 효과에 만족하고 있습니다..." 형태의 맞춤형 리뷰 요약 UI 노출.

### [Task 5] 시너지 상품 도출 및 크로스셀링 메시지 생성 (System & Agent)

* **Input:** 현재 선택된 상품 ID, `logs.json` (과거 유저 구매/조회 행동 로그), 현재 고객의 피부 고민 메타데이터.
* **Logic:** 1. **[System]:** 로그 데이터를 교차 분석하여 현재 상품과 함께 자주 구매/조회된 '페어링 상품' 선별.
2. **[Agent]:** 선별된 시너지 상품 리스트와 현재 고객의 피부 고민을 조합하여, "이 제품들을 함께 쓰면 시너지가 납니다"라는 개인화된 추천 프롬프트 실행.
* **Output:** 상세 페이지 하단에 개인화된 크로스셀링 유도 메시지와 추천 상품 카드 노출. (장바구니 담기 클릭 시 상태 제어 및 풍선 애니메이션 피드백 제공)
